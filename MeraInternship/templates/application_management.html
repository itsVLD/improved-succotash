<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Application Management | Internship Portal</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * {
      font-family: 'Inter', sans-serif;
    }
    
    h1, h2, h3, h4, h5, h6 {
      font-family: 'Poppins', sans-serif;
    }
    
    /* Sidebar Styles - Same gradient as other pages */
    .sidebar {
      width: 250px;
      height: 100vh;
      background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
      position: fixed;
      left: 0;
      top: 0;
      padding: 20px 0;
      color: white;
      z-index: 1000;
      box-shadow: 2px 0 10px rgba(0,0,0,0.1);
    }
    
    .brand {
      padding: 0 20px 20px;
      border-bottom: 1px solid rgba(255,255,255,0.2);
      margin-bottom: 20px;
      font-size: 1.5rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .sidebar nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .sidebar nav li {
      margin: 5px 0;
    }
    
    .sidebar nav a {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 20px;
      color: rgba(255,255,255,0.8);
      text-decoration: none;
      transition: all 0.3s ease;
      border-left: 3px solid transparent;
    }
    
    .sidebar nav a:hover {
      background: rgba(255,255,255,0.1);
      color: white;
    }
    
    .sidebar nav li.active a {
      background: rgba(255,255,255,0.15);
      color: white;
      border-left-color: white;
    }
    
    /* Main Content Area */
    .main-content {
      margin-left: 250px;
      min-height: 100vh;
      background: #f8fafc;
      padding: 30px;
    }
    
    /* Application Card Styles with Gradient Theme */
    .application-card {
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      background: white;
      height: 100%;
      display: flex;
      flex-direction: column;
      border: 1px solid #e2e8f0;
      position: relative;
    }
    
    .application-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #1e3a8a, #3b82f6, #1e3a8a);
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.5s ease;
    }
    
    .application-card:hover::before {
      transform: scaleX(1);
    }
    
    .application-card:hover {
      box-shadow: 0 20px 25px -5px rgba(59, 130, 246, 0.2), 0 10px 10px -5px rgba(59, 130, 246, 0.1);
      transform: translateY(-8px) scale(1.02);
    }
    
    .application-card-content {
      padding: 1.5rem;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }
    
    .status-badge {
      padding: 0.4rem 1rem;
      border-radius: 20px;
      font-weight: 600;
      font-size: 0.8rem;
      display: inline-block;
      align-self: flex-start;
    }
    
    .status-applied { 
      background: linear-gradient(135deg, #bae6fd, #7dd3fc);
      color: #0369a1;
    }
    .status-reviewed { 
      background: linear-gradient(135deg, #dbeafe, #93c5fd);
      color: #2563eb;
    }
    .status-interviewing { 
      background: linear-gradient(135deg, #c7f3d8, #86efac);
      color: #15803d;
    }
    .status-rejected { 
      background: linear-gradient(135deg, #fecaca, #fca5a5);
      color: #b91c1c;
    }
    .status-accepted { 
      background: linear-gradient(135deg, #bbf7d0, #4ade80);
      color: #166534;
    }
    .status-offer { 
      background: linear-gradient(135deg, #fef3c7, #fcd34d);
      color: #d97706;
    }
    
    .application-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
      margin-bottom: 2rem;
      max-height: 650px;
      overflow-y: auto;
      padding-right: 5px;
      scroll-behavior: smooth;
    }
    
    /* Scrollbar style */
    .application-grid::-webkit-scrollbar {
      width: 8px;
    }
    .application-grid::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #1e3a8a, #3b82f6);
      border-radius: 8px;
    }
    .application-grid::-webkit-scrollbar-track {
      background: #f1f5f9;
      border-radius: 8px;
    }
    
    .application-buttons {
      margin-top: auto;
      display: flex;
      gap: 0.75rem;
    }
    
    .btn {
      transition: all 0.3s ease;
      border-radius: 10px;
      font-weight: 600;
      font-size: 0.9rem;
      padding: 0.5rem 1rem;
      cursor: pointer;
      border: none;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }
    
    .btn.view {
      background: linear-gradient(135deg, #1e3a8a, #3b82f6);
      color: white;
      box-shadow: 0 2px 4px rgba(30, 58, 138, 0.2);
    }
    
    .btn.view:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(30, 58, 138, 0.3);
    }
    
    .btn.withdraw {
      background: linear-gradient(135deg, #ef4444, #dc2626);
      color: white;
      box-shadow: 0 2px 4px rgba(239, 68, 68, 0.2);
    }
    
    .btn.withdraw:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(239, 68, 68, 0.3);
    }
    
    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .stat-card {
      background: white;
      border-radius: 16px;
      padding: 1.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      gap: 1rem;
      border-left: 4px solid #3b82f6;
      transition: transform 0.3s ease;
    }
    
    .stat-card:hover {
      transform: translateY(-4px);
    }
    
    .stat-icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
    }
    
    .stat-total .stat-icon {
      background: linear-gradient(135deg, #3b82f6, #1e40af);
      color: white;
    }
    
    .stat-progress .stat-icon {
      background: linear-gradient(135deg, #f59e0b, #d97706);
      color: white;
    }
    
    .stat-accepted .stat-icon {
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
    }
    
    .stat-content {
      flex: 1;
    }
    
    .stat-number {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 0.25rem;
    }
    
    .stat-label {
      color: #6b7280;
      font-size: 0.9rem;
    }
    
    /* Search and Filter */
    .search-section {
      background: white;
      border-radius: 16px;
      padding: 1.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      margin-bottom: 2rem;
      border: 1px solid #e2e8f0;
    }
    
    .search-container {
      display: flex;
      gap: 1rem;
      align-items: center;
    }
    
    .search-input {
      flex: 1;
      border-radius: 12px;
      padding: 0.75rem 1rem;
      border: 1px solid #d1d5db;
      transition: all 0.2s ease;
      font-size: 1rem;
    }
    
    .search-input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .search-btn {
      background: linear-gradient(135deg, #1e3a8a, #3b82f6);
      color: white;
      border: none;
      border-radius: 12px;
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .search-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(30, 58, 138, 0.3);
    }
    
    /* Detail Section */
    .detail-section {
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      overflow: hidden;
      border: 1px solid #e2e8f0;
      animation: slideIn 0.5s ease-out;
    }
    
    .back-btn {
      transition: all 0.2s ease;
      border-radius: 10px;
      padding: 0.5rem 1rem;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      background: #f8fafc;
      border: 1px solid #e5e7eb;
      color: #374151;
      text-decoration: none;
    }
    
    .back-btn:hover {
      background: #f1f5f9;
    }
    
    .detail-action-btn {
      background: linear-gradient(135deg, #1e3a8a, #3b82f6);
      transition: all 0.3s ease;
      border-radius: 12px;
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      box-shadow: 0 4px 6px -1px rgba(30, 58, 138, 0.3);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .detail-action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(30, 58, 138, 0.4);
    }
    
    .detail-action-btn.withdraw {
      background: linear-gradient(135deg, #ef4444, #dc2626);
    }
    
    .info-box {
      background: #f8fafc;
      border-radius: 12px;
      padding: 1.5rem;
      border-left: 4px solid #3b82f6;
    }
    
    @keyframes slideIn {
      from { 
        opacity: 0;
        transform: translateY(20px);
      }
      to { 
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .fade-in {
      animation: fadeIn 0.6s ease-in;
    }
    
    @media (max-width: 768px) {
      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
      }
      
      .main-content {
        margin-left: 0;
      }
      
      .application-grid {
        grid-template-columns: 1fr;
      }
      
      .search-container {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <!-- Sidebar Navigation -->
  <aside class="sidebar">
    <div class="brand">
      <i class="fa-solid fa-briefcase"></i>
      Internship Portal
    </div>
    <nav>
      <ul>
        <li><a href="/dashboard"><i class="fa-solid fa-house"></i> Dashboard</a></li>
        <li><a href="/profile"><i class="fa-solid fa-user"></i> Profile</a></li>
        <li><a href="/assessment"><i class="fa-solid fa-clipboard-list"></i> Assessment Test</a></li>
        <li class="active"><a href="/applications"><i class="fa-solid fa-folder-open"></i> Application Management</a></li>
        <li><a href="/private_internships"><i class="fa-solid fa-user-lock"></i> Private Internships</a></li>
        <li><a href="/government_internships"><i class="fa-solid fa-building-columns"></i> Government Internships</a></li>
        <li><a href="/feedback"><i class="fa-solid fa-star"></i> Feedback</a></li>
        <li><a href="/logout"><i class="fa-solid fa-right-from-bracket"></i> Logout</a></li>
      </ul>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <div class="max-w-7xl mx-auto">
      <!-- Header -->
      <div class="mb-8">
        <h1 class="text-4xl font-bold mb-2 flex items-center">
          <i class="fa-solid fa-folder-open text-blue-600 mr-3"></i>
          Application Management
        </h1>
        <p class="text-gray-600 text-lg">Track and manage all your internship applications in one place</p>
      </div>

      <!-- Stats Cards -->
      <div class="stats-grid">
        <div class="stat-card stat-total">
          <div class="stat-icon">
            <i class="fa-solid fa-file-lines"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number" id="totalApplications">8</div>
            <div class="stat-label">Total Applications</div>
          </div>
        </div>
        
        <div class="stat-card stat-progress">
          <div class="stat-icon">
            <i class="fa-solid fa-spinner"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number" id="inProgress">5</div>
            <div class="stat-label">In Progress</div>
          </div>
        </div>
        
        <div class="stat-card stat-accepted">
          <div class="stat-icon">
            <i class="fa-solid fa-check-circle"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number" id="accepted">1</div>
            <div class="stat-label">Accepted</div>
          </div>
        </div>
      </div>

      <!-- Search Section -->
      <div class="search-section">
        <div class="search-container">
          <input 
            type="text" 
            id="applicationSearch" 
            placeholder="Search by company, position, or status..." 
            class="search-input"
          >
          <button class="search-btn" id="searchBtn">
            <i class="fa-solid fa-magnifying-glass"></i>
            Search
          </button>
        </div>
      </div>

      <!-- Application List -->
      <div id="applicationList" class="application-grid fade-in">
        <!-- Applications will be dynamically added here -->
      </div>

      <!-- Application Details Section -->
      <div id="application-detail" class="hidden detail-section p-8">
        <button onclick="backToList()" class="back-btn mb-6">
          <i class="fa-solid fa-arrow-left"></i> Back to Applications
        </button>
        
        <div class="flex flex-col lg:flex-row gap-8">
          <div class="lg:w-2/3">
            <div class="mb-6">
              <h2 id="detail-title" class="text-3xl font-bold text-gray-900 mb-2"></h2>
              <div class="flex items-center gap-4 mb-4">
                <span id="detail-status" class="status-badge"></span>
                <p class="text-gray-600"><strong>Applied On:</strong> <span id="detail-date"></span></p>
              </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
              <div class="info-box">
                <h3 class="text-xl font-semibold mb-3 text-blue-600">Internship Details</h3>
                <div class="space-y-2">
                  <p><strong>Company:</strong> <span id="detail-company"></span></p>
                  <p><strong>Position:</strong> <span id="detail-position"></span></p>
                  <p><strong>Location:</strong> <span id="detail-location"></span></p>
                  <p><strong>Duration:</strong> <span id="detail-duration"></span></p>
                  <p><strong>Stipend:</strong> <span id="detail-stipend"></span></p>
                </div>
              </div>
              
              <div class="info-box">
                <h3 class="text-xl font-semibold mb-3 text-blue-600">Application Timeline</h3>
                <div class="space-y-2">
                  <p><strong>Applied:</strong> <span id="detail-applied-date"></span></p>
                  <p><strong>Last Updated:</strong> <span id="detail-updated-date"></span></p>
                  <p><strong>Next Step:</strong> <span id="detail-next-step"></span></p>
                </div>
              </div>
            </div>
            
            <div class="mb-8">
              <h3 class="text-xl font-semibold mb-3 text-blue-600">Application Notes</h3>
              <div class="info-box">
                <p id="detail-notes" class="text-gray-700"></p>
              </div>
            </div>
          </div>
          
          <div class="lg:w-1/3">
            <div class="bg-blue-50 p-6 rounded-2xl sticky top-6 border border-blue-200">
              <h3 class="text-xl font-semibold mb-4 text-blue-800">Application Actions</h3>
              <div class="space-y-3">
                <button class="detail-action-btn w-full">
                  <i class="fa-solid fa-envelope"></i> Contact Recruiter
                </button>
                <button class="detail-action-btn withdraw w-full" id="detail-withdraw-btn">
                  <i class="fa-solid fa-times"></i> Withdraw Application
                </button>
              </div>
              <div class="mt-6 pt-6 border-t border-blue-200">
                <h4 class="font-semibold mb-2 text-blue-800">Application Tips</h4>
                <ul class="text-sm text-gray-600 space-y-2">
                  <li class="flex items-start gap-2">
                    <i class="fa-solid fa-check text-green-500 mt-1"></i>
                    <span>Follow up if you haven't heard back in 2 weeks</span>
                  </li>
                  <li class="flex items-start gap-2">
                    <i class="fa-solid fa-check text-green-500 mt-1"></i>
                    <span>Prepare for potential interviews</span>
                  </li>
                  <li class="flex items-start gap-2">
                    <i class="fa-solid fa-check text-green-500 mt-1"></i>
                    <span>Update your profile with new skills</span>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Sample data representing user applications
    const applications = [
      {
        id: 1,
        status: 'Applied',
        applied_on: '2025-08-15',
        last_updated: '2025-08-20',
        internship: {
          title: 'Frontend Developer Intern',
          company: 'Tech Solutions',
          location: 'Remote',
          duration: '3 Months',
          stipend: '₹10,000/month'
        },
        notes: 'Application submitted successfully. Waiting for recruiter response.',
        next_step: 'Application under review'
      },
      {
        id: 2,
        status: 'Interviewing',
        applied_on: '2025-07-20',
        last_updated: '2025-09-05',
        internship: {
          title: 'Data Analyst Intern',
          company: 'Data Insights',
          location: 'New Delhi',
          duration: '6 Months',
          stipend: '₹15,000/month'
        },
        notes: 'First round interview completed. Technical interview scheduled for next week.',
        next_step: 'Technical interview on Sept 20'
      },
      {
        id: 3,
        status: 'Rejected',
        applied_on: '2025-06-10',
        last_updated: '2025-07-15',
        internship: {
          title: 'Backend Developer Intern',
          company: 'CodeBase',
          location: 'Bangalore',
          duration: '4 Months',
          stipend: '₹12,000/month'
        },
        notes: 'Application declined after technical assessment.',
        next_step: 'No further action required'
      },
      {
        id: 4,
        status: 'Accepted',
        applied_on: '2025-08-01',
        last_updated: '2025-09-10',
        internship: {
          title: 'Machine Learning Intern',
          company: 'AI Innovations',
          location: 'Hybrid',
          duration: '5 Months',
          stipend: '₹20,000/month'
        },
        notes: 'Offer letter received. Start date: October 1, 2025.',
        next_step: 'Complete onboarding process'
      },
      {
        id: 5,
        status: 'Reviewed',
        applied_on: '2025-08-22',
        last_updated: '2025-09-01',
        internship: {
          title: 'UI/UX Design Intern',
          company: 'Creative Studio',
          location: 'Mumbai',
          duration: '3 Months',
          stipend: '₹8,000/month'
        },
        notes: 'Portfolio review completed. Awaiting design challenge.',
        next_step: 'Design challenge assignment'
      },
      {
        id: 6,
        status: 'Interviewing',
        applied_on: '2025-07-30',
        last_updated: '2025-09-12',
        internship: {
          title: 'Product Management Intern',
          company: 'Product Labs',
          location: 'Remote',
          duration: '6 Months',
          stipend: '₹18,000/month'
        },
        notes: 'Second round interview completed with product lead.',
        next_step: 'Final round with hiring manager'
      },
      {
        id: 7,
        status: 'Applied',
        applied_on: '2025-09-05',
        last_updated: '2025-09-05',
        internship: {
          title: 'Cybersecurity Intern',
          company: 'SecureTech',
          location: 'Pune',
          duration: '4 Months',
          stipend: '₹14,000/month'
        },
        notes: 'Application submitted. Screening in progress.',
        next_step: 'Initial screening'
      },
      {
        id: 8,
        status: 'Offer',
        applied_on: '2025-07-15',
        last_updated: '2025-09-08',
        internship: {
          title: 'Full Stack Developer Intern',
          company: 'WebCraft',
          location: 'Gurugram',
          duration: '5 Months',
          stipend: '₹16,000/month'
        },
        notes: 'Offer extended. Considering terms and conditions.',
        next_step: 'Respond to offer by Sept 20'
      }
    ];

    // Map application status to CSS class
    const statusClassMap = {
      'Applied': 'status-applied',
      'Reviewed': 'status-reviewed',
      'Interviewing': 'status-interviewing',
      'Rejected': 'status-rejected',
      'Accepted': 'status-accepted',
      'Offer': 'status-offer'
    };

    const applicationList = document.getElementById('applicationList');
    const detailSection = document.getElementById('application-detail');
    const searchInput = document.getElementById('applicationSearch');
    const searchBtn = document.getElementById('searchBtn');
    let currentAppId = null;

    function displayApplications(apps) {
      if (apps.length === 0) {
        applicationList.innerHTML = `
          <div class="col-span-full text-center py-12">
            <i class="fa-solid fa-search text-5xl text-gray-300 mb-4"></i>
            <h3 class="text-xl font-semibold text-gray-700 mb-2">No applications found</h3>
            <p class="text-gray-500">Try adjusting your search criteria</p>
          </div>
        `;
        return;
      }
      
      applicationList.innerHTML = apps.map(app => `
        <div class="application-card" data-id="${app.id}">
          <div class="application-card-content">
            <div class="flex justify-between items-start mb-3">
              <h3 class="font-bold text-xl text-gray-900">${app.internship.title}</h3>
              <span class="status-badge ${statusClassMap[app.status]}">${app.status}</span>
            </div>
            
            <div class="space-y-2 mb-4">
              <p class="text-gray-700 flex items-center gap-2">
                <i class="fa-solid fa-building text-blue-500"></i>
                ${app.internship.company}
              </p>
              <p class="text-gray-700 flex items-center gap-2">
                <i class="fa-solid fa-location-dot text-red-500"></i>
                ${app.internship.location}
              </p>
              <p class="text-gray-700 flex items-center gap-2">
                <i class="fa-solid fa-indian-rupee-sign text-green-500"></i>
                ${app.internship.stipend}
              </p>
              <p class="text-gray-700 flex items-center gap-2">
                <i class="fa-solid fa-calendar text-purple-500"></i>
                Applied: ${app.applied_on}
              </p>
            </div>
            
            <div class="application-buttons">
              <button class="btn view" onclick="showApplicationDetails(${app.id})">
                <i class="fa-solid fa-eye"></i> View Details
              </button>
              ${app.status === 'Applied' || app.status === 'Reviewed' ? 
                `<button class="btn withdraw" onclick="withdrawApplication(${app.id})">
                  <i class="fa-solid fa-times"></i> Withdraw
                </button>` : ''}
            </div>
          </div>
        </div>
      `).join('');
    }

    function showApplicationDetails(appId) {
      const app = applications.find(a => a.id === appId);
      if (!app) return;

      currentAppId = appId;
      
      // Hide the list and show details
      applicationList.style.display = 'none';
      detailSection.classList.remove('hidden');

      // Populate details
      document.getElementById('detail-title').textContent = app.internship.title;
      
      const statusSpan = document.getElementById('detail-status');
      statusSpan.textContent = app.status;
      statusSpan.className = `status-badge ${statusClassMap[app.status]}`;
      
      document.getElementById('detail-date').textContent = app.applied_on;
      document.getElementById('detail-company').textContent = app.internship.company;
      document.getElementById('detail-position').textContent = app.internship.title;
      document.getElementById('detail-location').textContent = app.internship.location;
      document.getElementById('detail-duration').textContent = app.internship.duration;
      document.getElementById('detail-stipend').textContent = app.internship.stipend;
      document.getElementById('detail-applied-date').textContent = app.applied_on;
      document.getElementById('detail-updated-date').textContent = app.last_updated;
      document.getElementById('detail-next-step').textContent = app.next_step;
      document.getElementById('detail-notes').textContent = app.notes;
      
      // Update withdraw button visibility
      const withdrawBtn = document.getElementById('detail-withdraw-btn');
      if (app.status === 'Applied' || app.status === 'Reviewed') {
        withdrawBtn.style.display = 'flex';
        withdrawBtn.onclick = () => withdrawApplication(appId);
      } else {
        withdrawBtn.style.display = 'none';
      }
    }

    function backToList() {
      detailSection.classList.add('hidden');
      applicationList.style.display = 'grid';
      currentAppId = null;
    }

    function withdrawApplication(appId) {
      if (confirm('Are you sure you want to withdraw this application? This action cannot be undone.')) {
        // In a real application, you would make an API call here
        const appIndex = applications.findIndex(app => app.id === appId);
        if (appIndex !== -1) {
          applications.splice(appIndex, 1);
          alert('Application withdrawn successfully.');
          
          // Refresh the application list
          displayApplications(applications);
          updateApplicationCounts();
          
          // If we're viewing the withdrawn application, go back to list
          if (currentAppId === appId) {
            backToList();
          }
        }
      }
    }

    function updateApplicationCounts() {
      const total = applications.length;
      const inProgress = applications.filter(app => 
        ['Applied', 'Reviewed', 'Interviewing'].includes(app.status)
      ).length;
      const accepted = applications.filter(app => 
        ['Accepted', 'Offer'].includes(app.status)
      ).length;
      
      document.getElementById('totalApplications').textContent = total;
      document.getElementById('inProgress').textContent = inProgress;
      document.getElementById('accepted').textContent = accepted;
    }

    // Search functionality
    searchBtn.addEventListener('click', performSearch);
    searchInput.addEventListener('keyup', (e) => {
      if (e.key === 'Enter') performSearch();
    });

    function performSearch() {
      const query = searchInput.value.toLowerCase().trim();
      if (!query) {
        displayApplications(applications);
        return;
      }
      
      const filtered = applications.filter(app =>
        app.internship.title.toLowerCase().includes(query) ||
        app.internship.company.toLowerCase().includes(query) ||
        app.status.toLowerCase().includes(query)
      );
      displayApplications(filtered);
    }

    // Initial load
    document.addEventListener('DOMContentLoaded', () => {
      displayApplications(applications);
      updateApplicationCounts();
    });
  </script>
</body>
</html>