<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard | Internship Portal</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * {
      font-family: 'Inter', sans-serif;
    }
    
    h1, h2, h3, h4, h5, h6 {
      font-family: 'Poppins', sans-serif;
    }
    
    /* Sidebar Styles - Same gradient as other pages */
    .sidebar {
      width: 250px;
      height: 100vh;
      background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
      position: fixed;
      left: 0;
      top: 0;
      padding: 20px 0;
      color: white;
      z-index: 1000;
      box-shadow: 2px 0 10px rgba(0,0,0,0.1);
    }
    
    .brand {
      padding: 0 20px 20px;
      border-bottom: 1px solid rgba(255,255,255,0.2);
      margin-bottom: 20px;
      font-size: 1.5rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .sidebar nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .sidebar nav li {
      margin: 5px 0;
    }
    
    .sidebar nav a {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 20px;
      color: rgba(255,255,255,0.8);
      text-decoration: none;
      transition: all 0.3s ease;
      border-left: 3px solid transparent;
    }
    
    .sidebar nav a:hover {
      background: rgba(255,255,255,0.1);
      color: white;
    }
    
    .sidebar nav li.active a {
      background: rgba(255,255,255,0.15);
      color: white;
      border-left-color: white;
    }
    
    /* Main Content Area */
    .main-content {
      margin-left: 250px;
      min-height: 100vh;
      background: #f8fafc;
      padding: 30px;
    }
    
    /* Stats Card Styles */
    .stats-card {
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      background: white;
      border: 1px solid #e2e8f0;
      position: relative;
    }
    
    .stats-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #1e3a8a, #3b82f6, #1e3a8a);
      transform: scaleX(1);
      transform-origin: left;
    }
    
    .stats-card:hover {
      box-shadow: 0 20px 25px -5px rgba(59, 130, 246, 0.2), 0 10px 10px -5px rgba(59, 130, 246, 0.1);
      transform: translateY(-8px) scale(1.02);
    }
    
    .stats-icon {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }
    
    .stats-content {
      flex: 1;
    }
    
    .stats-number {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 5px;
    }
    
    .stats-label {
      color: #6b7280;
      font-size: 0.9rem;
    }
    
    /* Quick Action Card Styles */
    .quick-action-card {
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      background: white;
      border: 1px solid #e2e8f0;
      position: relative;
      text-align: center;
      cursor: pointer;
      padding: 20px;
    }
    
    .quick-action-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #1e3a8a, #3b82f6, #1e3a8a);
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.5s ease;
    }
    
    .quick-action-card:hover::before {
      transform: scaleX(1);
    }
    
    .quick-action-card:hover {
      box-shadow: 0 20px 25px -5px rgba(59, 130, 246, 0.2), 0 10px 10px -5px rgba(59, 130, 246, 0.1);
      transform: translateY(-8px) scale(1.02);
    }
    
    .quick-action-icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      margin: 0 auto 15px;
    }
    
    /* Recent Activity Styles */
    .recent-activity {
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      background: white;
      border: 1px solid #e2e8f0;
      position: relative;
      padding: 20px;
    }
    
    .recent-activity::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #1e3a8a, #3b82f6, #1e3a8a);
      transform: scaleX(1);
      transform-origin: left;
    }
    
    .activity-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px 0;
      border-bottom: 1px solid #e5e7eb;
    }
    
    .activity-item:last-child {
      border-bottom: none;
    }
    
    .activity-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }
    
    .activity-content {
      flex: 1;
    }
    
    .activity-title {
      font-weight: 600;
      margin-bottom: 5px;
    }
    
    .activity-time {
      color: #6b7280;
      font-size: 0.85rem;
    }
    
    /* Recommended Internship Styles */
    .recommended-internship {
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      background: white;
      border: 1px solid #e2e8f0;
      position: relative;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .recommended-internship::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #1e3a8a, #3b82f6, #1e3a8a);
      transform: scaleX(1);
      transform-origin: left;
    }
    
    .recommended-internship:hover {
      box-shadow: 0 20px 25px -5px rgba(59, 130, 246, 0.2), 0 10px 10px -5px rgba(59, 130, 246, 0.1);
      transform: translateY(-8px) scale(1.02);
    }
    
    .internship-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }
    
    .internship-badge {
      background: linear-gradient(135deg, #bbf7d0, #4ade80);
      color: #166534;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background-color: #e5e7eb;
      border-radius: 4px;
      overflow: hidden;
      margin: 10px 0;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #1e3a8a, #3b82f6);
      border-radius: 4px;
    }
    
    .profile-completion {
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      background: white;
      border: 1px solid #e2e8f0;
      position: relative;
      padding: 20px;
    }
    
    .profile-completion::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #1e3a8a, #3b82f6, #1e3a8a);
      transform: scaleX(1);
      transform-origin: left;
    }

    /* Button Styles */
    .btn {
      transition: all 0.3s ease;
      border-radius: 10px;
      font-weight: 600;
      font-size: 0.9rem;
      padding: 0.75rem 1.5rem;
      cursor: pointer;
      border: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #1e3a8a, #3b82f6);
      color: white;
      box-shadow: 0 2px 4px rgba(30, 58, 138, 0.2);
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(30, 58, 138, 0.3);
    }
    
    /* CHAT BOT STYLES */
    .chat-bubble {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      z-index: 1000;
      transition: all 0.3s ease;
      animation: pulse 2s infinite;
    }

    .chat-bubble:hover {
      transform: scale(1.1);
      box-shadow: 0 12px 35px rgba(102, 126, 234, 0.6);
    }

    .chat-bubble i {
      color: white;
      font-size: 24px;
    }

    .chat-sidebar {
      position: fixed;
      top: 0;
      right: -400px;
      width: 380px;
      height: 100vh;
      background: white;
      box-shadow: -5px 0 25px rgba(0, 0, 0, 0.1);
      z-index: 1001;
      transition: right 0.3s ease;
      display: flex;
      flex-direction: column;
    }

    .chat-sidebar.open {
      right: 0;
    }

    .chat-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .chat-header h3 {
      margin: 0;
      font-size: 1.2rem;
    }

    .close-chat {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 5px;
    }

    .chat-messages {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background: #f8fafc;
    }

    .message {
      margin-bottom: 15px;
      display: flex;
      align-items: flex-start;
    }

    .message.bot {
      justify-content: flex-start;
    }

    .message.user {
      justify-content: flex-end;
    }

    .message-content {
      max-width: 80%;
      padding: 12px 16px;
      border-radius: 18px;
      font-size: 0.9rem;
      line-height: 1.4;
    }

    .message.bot .message-content {
      background: white;
      border: 1px solid #e2e8f0;
      border-bottom-left-radius: 5px;
    }

    .message.user .message-content {
      background: #667eea;
      color: white;
      border-bottom-right-radius: 5px;
    }

    .chat-input {
      padding: 20px;
      border-top: 1px solid #e2e8f0;
      background: white;
    }

    .input-group {
      display: flex;
      gap: 10px;
    }

    .chat-input input {
      flex: 1;
      padding: 12px 16px;
      border: 1px solid #e2e8f0;
      border-radius: 25px;
      outline: none;
      font-size: 0.9rem;
    }

    .chat-input input:focus {
      border-color: #667eea;
    }

    .send-button {
      background: #667eea;
      color: white;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .send-button:hover {
      background: #5a6fd8;
    }

    .quick-questions {
      padding: 15px 20px;
      border-bottom: 1px solid #e2e8f0;
    }

    .quick-questions h4 {
      margin: 0 0 10px 0;
      font-size: 0.9rem;
      color: #64748b;
    }

    .question-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .question-chip {
      background: #f1f5f9;
      border: 1px solid #e2e8f0;
      border-radius: 20px;
      padding: 8px 16px;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .question-chip:hover {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .overlay.active {
      opacity: 1;
      visibility: visible;
    }

    @keyframes pulse {
      0% {
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      }
      50% {
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.8);
      }
      100% {
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      }
    }

    @media (max-width: 768px) {
      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
      }
      
      .main-content {
        margin-left: 0;
      }
      
      .chat-sidebar {
        width: 100%;
        right: -100%;
      }
      
      .chat-bubble {
        bottom: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
      }
      
      .chat-bubble i {
        font-size: 20px;
      }
    }
  </style>
</head>
<body>
  <!-- Sidebar Navigation -->
  <aside class="sidebar">
    <div class="brand">
      <i class="fa-solid fa-briefcase"></i>
      Internship Portal
    </div>
    <nav>
      <ul>
        <li class="active"><a href="/dashboard"><i class="fa-solid fa-house"></i> Dashboard</a></li>
        <li><a href="/profile"><i class="fa-solid fa-user"></i> Profile</a></li>
        <li><a href="/assessment"><i class="fa-solid fa-clipboard-list"></i> Assessment Test</a></li>
        <li><a href="/applications"><i class="fa-solid fa-folder-open"></i> Application Management</a></li>
        <li><a href="/private_internships"><i class="fa-solid fa-user-lock"></i> Private Internships</a></li>
        <li><a href="/government_internships"><i class="fa-solid fa-building-columns"></i> Government Internships</a></li>
        <li><a href="/feedback"><i class="fa-solid fa-star"></i> Feedback</a></li>
        <li><a href="/logout"><i class="fa-solid fa-right-from-bracket"></i> Logout</a></li>
      </ul>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <div class="max-w-7xl mx-auto">
      <!-- Welcome Header -->
      <header class="mb-8">
        <div class="flex justify-between items-center">
          <div>
            <h1 class="text-4xl font-bold text-gray-800 mb-2">Welcome back, <span id="usernameDisplay">Loading...</span>! 👋</h1>
            <p class="text-gray-600 text-lg">Here's what's happening with your internship applications today.</p>
          </div>
          <div class="text-right">
            <p class="text-gray-600">Today is <span id="currentDate"></span></p>
            <p class="text-sm text-gray-500" id="currentTime"></p>
          </div>
        </div>
      </header>

      <!-- Stats Cards -->
      <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="stats-card p-6 flex items-center gap-4">
          <div class="stats-icon" style="background: linear-gradient(135deg, #dbeafe, #93c5fd); color: #1e40af;">
            <i class="fa-solid fa-briefcase"></i>
          </div>
          <div class="stats-content">
            <div class="stats-number" id="totalApplications">8</div>
            <div class="stats-label">Total Applications</div>
          </div>
        </div>
        
        <div class="stats-card p-6 flex items-center gap-4">
          <div class="stats-icon" style="background: linear-gradient(135deg, #d1fae5, #86efac); color: #065f46;">
            <i class="fa-solid fa-check-circle"></i>
          </div>
          <div class="stats-content">
            <div class="stats-number" id="interviews">3</div>
            <div class="stats-label">Upcoming Interviews</div>
          </div>
        </div>
        
        <div class="stats-card p-6 flex items-center gap-4">
          <div class="stats-icon" style="background: linear-gradient(135deg, #fef3c7, #fcd34d); color: #92400e;">
            <i class="fa-solid fa-clock"></i>
          </div>
          <div class="stats-content">
            <div class="stats-number" id="pending">5</div>
            <div class="stats-label">Pending Reviews</div>
          </div>
        </div>
        
        <div class="stats-card p-6 flex items-center gap-4">
          <div class="stats-icon" style="background: linear-gradient(135deg, #e0e7ff, #a5b4fc); color: #3730a3;">
            <i class="fa-solid fa-trophy"></i>
          </div>
          <div class="stats-content">
            <div class="stats-number" id="offers">1</div>
            <div class="stats-label">Job Offers</div>
          </div>
        </div>
      </section>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Left Column -->
        <div class="lg:col-span-2">
          <!-- Quick Actions -->
          <section class="mb-8">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Quick Actions</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
              <div class="quick-action-card" onclick="window.location.href='/profile'">
                <div class="quick-action-icon" style="background: linear-gradient(135deg, #dbeafe, #93c5fd); color: #1e40af;">
                  <i class="fa-solid fa-user-edit"></i>
                </div>
                <div class="font-semibold">Update Profile</div>
              </div>
              
              <div class="quick-action-card" onclick="window.location.href='/assessment'">
                <div class="quick-action-icon" style="background: linear-gradient(135deg, #d1fae5, #86efac); color: #065f46;">
                  <i class="fa-solid fa-clipboard-check"></i>
                </div>
                <div class="font-semibold">Take Assessment</div>
              </div>
              
              <div class="quick-action-card" onclick="window.location.href='/private_internships'">
                <div class="quick-action-icon" style="background: linear-gradient(135deg, #fef3c7, #fcd34d); color: #92400e;">
                  <i class="fa-solid fa-building"></i>
                </div>
                <div class="font-semibold">Browse Internships</div>
              </div>
              
              <div class="quick-action-card" onclick="window.location.href='/applications'">
                <div class="quick-action-icon" style="background: linear-gradient(135deg, #e0e7ff, #a5b4fc); color: #3730a3;">
                  <i class="fa-solid fa-list-check"></i>
                </div>
                <div class="font-semibold">View Applications</div>
              </div>
            </div>
          </section>

          <!-- Recommended Internships -->
          <section class="mb-8">
            <div class="flex justify-between items-center mb-4">
              <h2 class="text-xl font-bold text-gray-800">Recommended For You</h2>
              <a href="/private_internships" class="text-blue-600 hover:text-blue-800 font-medium">View All</a>
            </div>
            
            <div id="recommendedInternships">
              <!-- Internships will be loaded here -->
            </div>
          </section>
        </div>

        <!-- Right Column -->
        <div class="space-y-8">
          <!-- Profile Completion -->
          <section class="profile-completion">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Profile Completion</h2>
            <div class="mb-4">
              <div class="flex justify-between text-sm mb-2">
                <span>Completion Status</span>
                <span id="completionPercent">75%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 75%"></div>
              </div>
            </div>
            <ul class="space-y-3">
              <li class="flex items-center">
                <i class="fa-solid fa-check text-green-500 mr-3"></i>
                <span class="text-gray-700">Personal Information</span>
              </li>
              <li class="flex items-center">
                <i class="fa-solid fa-check text-green-500 mr-3"></i>
                <span class="text-gray-700">Education Details</span>
              </li>
              <li class="flex items-center">
                <i class="fa-solid fa-check text-green-500 mr-3"></i>
                <span class="text-gray-700">Skills & Expertise</span>
              </li>
              <li class="flex items-center">
                <i class="fa-solid fa-times text-red-500 mr-3"></i>
                <span class="text-gray-700">Upload Resume</span>
              </li>
              <li class="flex items-center">
                <i class="fa-solid fa-times text-red-500 mr-3"></i>
                <span class="text-gray-700">Complete Assessment</span>
              </li>
            </ul>
            <button class="btn btn-primary w-full mt-4" onclick="window.location.href='/profile'">
              Complete Your Profile
            </button>
          </section>

          <!-- Recent Activity -->
          <section class="recent-activity">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Recent Activity</h2>
            <div id="recentActivities">
              <!-- Activities will be loaded here -->
            </div>
          </section>

          <!-- Upcoming Deadlines -->
          <section class="recent-activity">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Upcoming Deadlines</h2>
            <div id="upcomingDeadlines">
              <!-- Deadlines will be loaded here -->
            </div>
          </section>
        </div>
      </div>
    </div>
  </main>

  <!-- CHAT BOT ELEMENTS -->
  <div class="chat-bubble" id="chatBubble">
    <i class="fa-solid fa-robot"></i>
  </div>

  <div class="overlay" id="chatOverlay"></div>

  <div class="chat-sidebar" id="chatSidebar">
    <div class="chat-header">
      <h3>Internship Portal Assistant</h3>
      <button class="close-chat" id="closeChat">
        <i class="fa-solid fa-times"></i>
      </button>
    </div>

    <div class="quick-questions">
      <h4>Quick Questions</h4>
      <div class="question-chips">
        <div class="question-chip" data-question="How do I apply for internships?">How to apply?</div>
        <div class="question-chip" data-question="What is the assessment test?">About assessments</div>
        <div class="question-chip" data-question="How to update my profile?">Update profile</div>
        <div class="question-chip" data-question="What are private internships?">Private internships</div>
      </div>
    </div>

    <div class="chat-messages" id="chatMessages">
      <div class="message bot">
        <div class="message-content">
          Hello! I'm your Internship Portal assistant. How can I help you today? You can ask me about applications, assessments, profiles, or anything else related to the portal!
        </div>
      </div>
    </div>

    <div class="chat-input">
      <div class="input-group">
        <input type="text" id="chatInput" placeholder="Type your question here..." maxlength="500">
        <button class="send-button" id="sendMessage">
          <i class="fa-solid fa-paper-plane"></i>
        </button>
      </div>
    </div>
  </div>

  <script>
    // Dashboard functionality
    
    // Get the current username (same as in profile.js)
    function getCurrentUsername() {
      return localStorage.getItem('currentUser') || 'default_user';
    }

    // All available internships database
    const allInternships = [
      {
        id: 1,
        title: "Frontend Developer Intern",
        company: "Tech Solutions Inc.",
        location: "Remote",
        type: "Private",
        match: 95,
        stipend: "₹15,000/month",
        deadline: "2025-09-30",
        logo: "https://cdn-icons-png.flaticon.com/512/1006/1006771.png",
        specialization: "frontend_developer",
        requiredSkills: ["HTML", "CSS", "JavaScript", "React", "Responsive Design"],
        description: "Join our frontend team to build amazing user interfaces using modern web technologies."
      },
      {
        id: 2,
        title: "Data Analyst Intern",
        company: "Data Insights Co.",
        location: "Bangalore",
        type: "Private",
        match: 88,
        stipend: "₹18,000/month",
        deadline: "2025-10-15",
        logo: "https://cdn-icons-png.flaticon.com/512/2910/2910768.png",
        specialization: "data_analyst",
        requiredSkills: ["SQL", "Python", "Excel", "Tableau", "Data Analysis"],
        description: "Work with our data team to analyze business metrics and create insightful reports."
      },
      {
        id: 3,
        title: "Backend Developer Intern",
        company: "API Masters",
        location: "Hyderabad",
        type: "Private",
        match: 92,
        stipend: "₹20,000/month",
        deadline: "2025-10-05",
        logo: "https://cdn-icons-png.flaticon.com/512/2920/2920277.png",
        specialization: "backend_developer",
        requiredSkills: ["Node.js", "Python", "SQL", "API Development", "System Architecture"],
        description: "Develop robust backend systems and APIs for our enterprise applications."
      },
      {
        id: 4,
        title: "Full Stack Developer Intern",
        company: "WebCraft Solutions",
        location: "Remote",
        type: "Private",
        match: 90,
        stipend: "₹22,000/month",
        deadline: "2025-10-20",
        logo: "https://cdn-icons-png.flaticon.com/512/2282/2282188.png",
        specialization: "full_stack_developer",
        requiredSkills: ["HTML/CSS", "JavaScript", "React", "Node.js", "SQL"],
        description: "End-to-end web development experience working on real client projects."
      },
      {
        id: 5,
        title: "Data Scientist Intern",
        company: "AI Innovations",
        location: "Bangalore",
        type: "Private",
        match: 85,
        stipend: "₹25,000/month",
        deadline: "2025-10-12",
        logo: "https://cdn-icons-png.flaticon.com/512/2103/2103633.png",
        specialization: "data_scientist",
        requiredSkills: ["Python", "Machine Learning", "Statistics", "Data Visualization"],
        description: "Apply machine learning algorithms to solve complex business problems."
      },
      {
        id: 6,
        title: "Business Analyst Intern",
        company: "Strategy Partners",
        location: "Mumbai",
        type: "Private",
        match: 82,
        stipend: "₹16,000/month",
        deadline: "2025-09-28",
        logo: "https://cdn-icons-png.flaticon.com/512/3135/3135715.png",
        specialization: "business_analyst",
        requiredSkills: ["Requirements Gathering", "Process Modeling", "Stakeholder Management"],
        description: "Bridge the gap between business needs and technical solutions."
      }
    ];

    const recentActivities = [
      {
        id: 1,
        type: "application",
        title: "Application submitted",
        description: "Frontend Developer at Tech Solutions",
        time: "2 hours ago",
        icon: "fa-solid fa-paper-plane",
        color: "bg-blue-100 text-blue-600"
      },
      {
        id: 2,
        type: "interview",
        title: "Interview scheduled",
        description: "Data Analyst at Data Insights Co.",
        time: "1 day ago",
        icon: "fa-solid fa-calendar-check",
        color: "bg-green-100 text-green-600"
      },
      {
        id: 3,
        type: "assessment",
        title: "Assessment completed",
        description: "Web Development test - Score: 85%",
        time: "2 days ago",
        icon: "fa-solid fa-clipboard-check",
        color: "bg-purple-100 text-purple-600"
      }
    ];

    const upcomingDeadlines = [
      {
        id: 1,
        title: "Web Developer Intern",
        company: "WebCraft Solutions",
        deadline: "2025-09-25",
        daysLeft: 3,
        type: "urgent"
      },
      {
        id: 2,
        title: "ML Engineer Intern",
        company: "AI Innovations",
        deadline: "2025-10-10",
        daysLeft: 18,
        type: "warning"
      }
    ];

    function initializeDashboard() {
      // Load user data from profile storage
      const username = getCurrentUsername();
      const userData = JSON.parse(localStorage.getItem(`user_${username}`)) || {};
      const userPreferences = JSON.parse(localStorage.getItem(`user_preferences_${username}`)) || {};
      
      // Update username display with actual user data
      const firstName = userData.firstName || 'User';
      document.getElementById('usernameDisplay').textContent = firstName;
      
      // Calculate profile completion percentage
      const profileCompletion = calculateProfileCompletion(userData);
      document.getElementById('completionPercent').textContent = `${profileCompletion}%`;
      document.querySelector('.progress-fill').style.width = `${profileCompletion}%`;
      
      // Update stats
      document.getElementById('totalApplications').textContent = userData.stats?.totalApplications || 8;
      document.getElementById('interviews').textContent = userData.stats?.interviews || 3;
      document.getElementById('pending').textContent = userData.stats?.pending || 5;
      document.getElementById('offers').textContent = userData.stats?.offers || 1;
      
      // Load personalized recommendations
      loadPersonalizedInternships(userData, userPreferences);
      loadRecentActivities();
      loadUpcomingDeadlines();
      updateDateTime();
      setInterval(updateDateTime, 1000);
    }

    function calculateProfileCompletion(userData) {
      let completion = 0;
      const fields = [
        userData.firstName, userData.lastName, userData.email,
        userData.country, userData.city, userData.college,
        userData.course, userData.specialization, userData.skills?.length > 0,
        userData.bio, userData.resumeName !== 'No resume uploaded'
      ];
      
      const completedFields = fields.filter(Boolean).length;
      return Math.round((completedFields / fields.length) * 100);
    }

    function loadPersonalizedInternships(userData, userPreferences) {
      const container = document.getElementById('recommendedInternships');
      
      // Get user's specialization and skills
      const userSpecialization = userData.specialization || userPreferences.specialization;
      const userSkills = userData.skills || userPreferences.skills || [];
      const userLocation = userData.city || userPreferences.location?.city;
      
      // Filter and sort internships based on user profile
      let recommendedInternships = allInternships
        .map(internship => {
          // Calculate match score based on user profile
          let matchScore = calculateMatchScore(internship, userSpecialization, userSkills, userLocation);
          return { ...internship, match: matchScore };
        })
        .filter(internship => internship.match >= 70) // Only show internships with good match
        .sort((a, b) => b.match - a.match) // Sort by match score descending
        .slice(0, 3); // Show top 3 recommendations
      
      // If no personalized recommendations, show default ones
      if (recommendedInternships.length === 0) {
        recommendedInternships = allInternships.slice(0, 3).map(internship => ({
          ...internship,
          match: 75 // Default match score
        }));
      }
      
      container.innerHTML = recommendedInternships.map(internship => `
        <div class="recommended-internship" onclick="viewInternship(${internship.id})">
          <div class="internship-header">
            <div class="flex items-start gap-4 flex-1">
              <img src="${internship.logo}" alt="${internship.company}" class="w-12 h-12 rounded-lg">
              <div class="flex-1">
                <h3 class="font-bold text-lg text-gray-800">${internship.title}</h3>
                <p class="text-gray-600">${internship.company} • ${internship.location}</p>
                <p class="text-sm text-gray-500 mt-1">${internship.description}</p>
              </div>
            </div>
            <div class="internship-badge">${internship.match}% Match</div>
          </div>
          
          <div class="flex justify-between items-center text-sm text-gray-600 mb-3">
            <span><i class="fa-solid fa-indian-rupee-sign mr-1"></i> ${internship.stipend}</span>
            <span><i class="fa-solid fa-clock mr-1"></i> Apply by ${formatDate(internship.deadline)}</span>
          </div>
          
          <div class="mb-3">
            <div class="text-sm text-gray-600 mb-1">Required Skills:</div>
            <div class="flex flex-wrap gap-1">
              ${internship.requiredSkills.map(skill => `
                <span class="px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-full">${skill}</span>
              `).join('')}
            </div>
          </div>
          
          <button class="btn btn-primary w-full">
            Apply Now
          </button>
        </div>
      `).join('');
    }

    function calculateMatchScore(internship, userSpecialization, userSkills, userLocation) {
      let score = 50; // Base score
      
      // Specialization match (30 points)
      if (internship.specialization === userSpecialization) {
        score += 30;
      }
      
      // Skills match (up to 40 points)
      const matchedSkills = internship.requiredSkills.filter(skill => 
        userSkills.some(userSkill => 
          userSkill.toLowerCase().includes(skill.toLowerCase()) || 
          skill.toLowerCase().includes(userSkill.toLowerCase())
        )
      ).length;
      
      score += (matchedSkills / internship.requiredSkills.length) * 40;
      
      // Location match (10 points)
      if (userLocation && internship.location.toLowerCase().includes(userLocation.toLowerCase())) {
        score += 10;
      }
      
      // Cap at 100
      return Math.min(Math.round(score), 100);
    }

    function loadRecentActivities() {
      const container = document.getElementById('recentActivities');
      container.innerHTML = recentActivities.map(activity => `
        <div class="activity-item">
          <div class="activity-icon ${activity.color}">
            <i class="${activity.icon}"></i>
          </div>
          <div class="activity-content">
            <div class="activity-title">${activity.title}</div>
            <div class="activity-description text-gray-600 text-sm">${activity.description}</div>
          </div>
          <div class="activity-time">${activity.time}</div>
        </div>
      `).join('');
    }

    function loadUpcomingDeadlines() {
      const container = document.getElementById('upcomingDeadlines');
      container.innerHTML = upcomingDeadlines.map(deadline => `
        <div class="activity-item">
          <div class="activity-icon ${getDeadlineColor(deadline.type)}">
            <i class="fa-solid fa-hourglass-half"></i>
          </div>
          <div class="activity-content">
            <div class="activity-title">${deadline.title}</div>
            <div class="activity-description text-gray-600 text-sm">${deadline.company}</div>
          </div>
          <div class="activity-time ${getDeadlineTextColor(deadline.type)} font-semibold">
            ${deadline.daysLeft}d
          </div>
        </div>
      `).join('');
    }

    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
    }

    function getDeadlineColor(type) {
      switch(type) {
        case 'urgent': return 'bg-red-100 text-red-600';
        case 'warning': return 'bg-yellow-100 text-yellow-600';
        default: return 'bg-blue-100 text-blue-600';
      }
    }

    function getDeadlineTextColor(type) {
      switch(type) {
        case 'urgent': return 'text-red-600';
        case 'warning': return 'text-yellow-600';
        default: return 'text-blue-600';
      }
    }

    function updateDateTime() {
      const now = new Date();
      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      document.getElementById('currentDate').textContent = now.toLocaleDateString('en-US', options);
      document.getElementById('currentTime').textContent = now.toLocaleTimeString('en-US', { 
        hour: '2-digit', 
        minute: '2-digit',
        second: '2-digit'
      });
    }

    function viewInternship(id) {
      // In a real app, this would navigate to the internship detail page
      alert(`Viewing internship details for ID: ${id}`);
      // window.location.href = `/internship/${id}`;
    }

    // CHAT BOT FUNCTIONALITY (same as before)
    const chatBubble = document.getElementById('chatBubble');
    const chatSidebar = document.getElementById('chatSidebar');
    const closeChat = document.getElementById('closeChat');
    const chatOverlay = document.getElementById('chatOverlay');
    const chatMessages = document.getElementById('chatMessages');
    const chatInput = document.getElementById('chatInput');
    const sendMessage = document.getElementById('sendMessage');
    const questionChips = document.querySelectorAll('.question-chip');

    const botResponses = {
      'default': "I'm here to help you with the Internship Portal! You can ask me about:\n\n• Applying for internships\n• Assessment tests\n• Profile management\n• Application tracking\n• Private vs Government internships\n• Technical issues\n\nWhat would you like to know?",
      
      'hello': "Hello! 👋 I'm your Internship Portal assistant. How can I help you today?",
      
      'how do i apply for internships?': "To apply for internships:\n\n1. Go to 'Private Internships' or 'Government Internships'\n2. Browse available positions\n3. Click 'Apply Now' on your preferred internship\n4. Your application will be tracked in 'Application Management'\n\nYou can also use the search feature to find specific internships!",
      
      'what is the assessment test?': "The assessment tests help evaluate your skills and match you with suitable internships:\n\n• Available in the 'Assessment Test' section\n• Various categories (Programming, Web Dev, etc.)\n• Timed tests with instant results\n• Scores help in internship recommendations\n\nCompleting assessments improves your profile visibility!",
      
      'how to update my profile?': "Updating your profile:\n\n1. Go to 'Profile' section\n2. Fill in your personal, education, and skill details\n3. Upload your resume\n4. Complete the profile completion checklist\n5. Save your changes\n\nA complete profile increases your chances of getting selected!",
      
      'what are private internships?': "Private internships are offered by companies and organizations in the private sector:\n\n• Various domains (Tech, Marketing, Design, etc.)\n• Different stipend ranges\n• Remote, hybrid, or on-site options\n• Specific application deadlines\n\nCheck the 'Private Internships' section to browse all available opportunities!",
      
      'how to track my applications?': "Track your applications in the 'Application Management' section:\n\n• View all submitted applications\n• See application status (Applied, Reviewed, Interviewing, etc.)\n• Check upcoming deadlines\n• Withdraw applications if needed\n• View detailed application history",
      
      'what are government internships?': "Government internships are offered by various government departments and initiatives:\n\n• Programs like TULIP, Smart Cities Mission\n• Focus on public service and governance\n• Stipends as per government norms\n• Certificate upon completion\n\nCheck 'Government Internships' for current opportunities!",
      
      'how does the recommendation system work?': "Our recommendation system:\n\n• Analyzes your profile skills and education\n• Considers your assessment test scores\n• Matches you with relevant internships\n• Updates recommendations regularly\n• Personalizes based on your interests",
      
      'can i withdraw an application?': "Yes! You can withdraw applications:\n\n1. Go to 'Application Management'\n2. Find the application you want to withdraw\n3. Click 'Withdraw' button\n4. Confirm your decision\n\nNote: Withdrawn applications cannot be recovered.",
      
      'how to prepare for assessments?': "Assessment preparation tips:\n\n• Review the test categories beforehand\n• Practice with sample questions\n• Ensure stable internet connection\n• Manage your time effectively\n• Read questions carefully\n• Complete your profile first for better matching",
      
      'technical issues': "For technical issues:\n\n• Refresh the page first\n• Clear browser cache if needed\n• Check your internet connection\n• Try using a different browser\n• Ensure JavaScript is enabled\n\nIf issues persist, please contact support with details about the problem.",
      
      'thank you': "You're welcome! 😊 Is there anything else I can help you with regarding the Internship Portal?",
    };

    function addMessage(message, isUser = false) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;
      
      const messageContent = document.createElement('div');
      messageContent.className = 'message-content';
      messageContent.innerHTML = message.replace(/\n/g, '<br>');
      
      messageDiv.appendChild(messageContent);
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function getBotResponse(userMessage) {
      const lowerMessage = userMessage.toLowerCase().trim();
      
      for (const [key, response] of Object.entries(botResponses)) {
        if (lowerMessage.includes(key)) {
          return response;
        }
      }
      
      if (lowerMessage.includes('apply') || lowerMessage.includes('application')) {
        return botResponses['how do i apply for internships?'];
      } else if (lowerMessage.includes('assessment') || lowerMessage.includes('test')) {
        return botResponses['what is the assessment test?'];
      } else if (lowerMessage.includes('profile') || lowerMessage.includes('update')) {
        return botResponses['how to update my profile?'];
      } else if (lowerMessage.includes('private')) {
        return botResponses['what are private internships?'];
      } else if (lowerMessage.includes('government')) {
        return botResponses['what are government internships?'];
      } else if (lowerMessage.includes('track') || lowerMessage.includes('status')) {
        return botResponses['how to track my applications?'];
      } else if (lowerMessage.includes('recommend') || lowerMessage.includes('suggest')) {
        return botResponses['how does the recommendation system work?'];
      } else if (lowerMessage.includes('withdraw') || lowerMessage.includes('cancel')) {
        return botResponses['can i withdraw an application?'];
      } else if (lowerMessage.includes('prepare') || lowerMessage.includes('practice')) {
        return botResponses['how to prepare for assessments?'];
      } else if (lowerMessage.includes('technical') || lowerMessage.includes('error') || lowerMessage.includes('issue')) {
        return botResponses['technical issues'];
      } else if (lowerMessage.includes('thank') || lowerMessage.includes('thanks')) {
        return botResponses['thank you'];
      } else if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
        return botResponses['hello'];
      }
      
      return botResponses['default'];
    }

    function sendUserMessage() {
      const message = chatInput.value.trim();
      if (message === '') return;
      
      addMessage(message, true);
      chatInput.value = '';
      
      const typingDiv = document.createElement('div');
      typingDiv.className = 'message bot';
      typingDiv.innerHTML = '<div class="message-content"><i>Assistant is typing...</i></div>';
      chatMessages.appendChild(typingDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      setTimeout(() => {
        chatMessages.removeChild(typingDiv);
        const botResponse = getBotResponse(message);
        addMessage(botResponse, false);
      }, 1000 + Math.random() * 1000);
    }

    // Chat event listeners
    chatBubble.addEventListener('click', () => {
      chatSidebar.classList.add('open');
      chatOverlay.classList.add('active');
      chatInput.focus();
    });

    closeChat.addEventListener('click', () => {
      chatSidebar.classList.remove('open');
      chatOverlay.classList.remove('active');
    });

    chatOverlay.addEventListener('click', () => {
      chatSidebar.classList.remove('open');
      chatOverlay.classList.remove('active');
    });

    sendMessage.addEventListener('click', sendUserMessage);

    chatInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        sendUserMessage();
      }
    });

    questionChips.forEach(chip => {
      chip.addEventListener('click', () => {
        const question = chip.getAttribute('data-question');
        chatInput.value = question;
        sendUserMessage();
      });
    });

    chatSidebar.addEventListener('transitionend', () => {
      if (chatSidebar.classList.contains('open')) {
        chatInput.focus();
      }
    });

    // Initialize dashboard
    document.addEventListener('DOMContentLoaded', initializeDashboard);
  </script>
</body>
</html>